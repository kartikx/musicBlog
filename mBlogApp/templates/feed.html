{% extends "layout.html" %}
<!-- is this needed? -->
{% load static %}
{% load widget_tweaks %}

{% block genreheading %}
{% endblock genreheading %}

{% block content %}
    <div class="feed">
    <!-- {% if current_user.is_authenticated %} -->
    <!-- {% endif %} -->

   {% for post in posts %}
    <div class="feed-post">
        <div class="post-profile-photo">
            <a href="#" data-tooltip="{{post.author.username}}">
            <img src="{% static post.author.userprofile.profile_photo.url %}"
             class="rounded-circle" height= 35px>
            </a>
        </div>
        
        <div class="post-title">
            <h2>{{post.title}} - {{post.artist}}</h2>
        </div>
        
        <div class="post-album-art">
            <a href="{{post.spotifylink}}" target="_blank">
            <img src = "{% static 'AlbumArt/'|add:post.albumart %}" >
            </a>
        </div>
        
        <div class="post-content">
            {{post.content}}
        </div>
        <div class="post-tags">
            {% for genre in post.genres.all %}
                <a class="tag-link" href="#">
                    {{genre.name}}
                </a>
            {% endfor %}
        </div>
    </div>
    {% endfor %}

    <div class="create-post-modal">
        <div class="modal-close">
            X
        </div>
        <div class="create-post-form">
            <form method="POST" action="">
                {% csrf_token %}
                <legend class="border-bottom">Create Post</legend>  

                <div class="form-row">
                    <!-- {{form.song.label_tag}} -->
                    <div class="form-group col"><span class="form__label">{{form.song.label_tag}}</span>{% render_field form.song class="form-control" %}</div>
                    <div class="form-group col"><span class="form__label">{{form.artist.label_tag}}</span>{% render_field form.artist class="form-control" %}</div>
                </div>
                <div class="form-row">
                    <div class="form-group col">
                        <span class="form__label">{{form.content.label_tag}}</span>
                        {% render_field form.content class="form-control" %}
                    </div>
                </div>

                <button type="submit" class="btn btn-outline-success">Post</button>
            </form>
        </div>
    </div>

    {% if not user.is_authenticated %}
        <div class="sign-up-box">
            <div class="hero"></div>
            <span class="intro-text">MusicBlog is <strong>THE</strong> place 
            to share Music with the people you love. Don't miss out on the tons of
            cool features. It just takes one minute to create an account!</span>
            <a href="{% url 'register' %}">Sign Up</a>
        </div>
    {% endif %}
    <script src = "{% static 'JS/modal.js' %}"></script>
    <script src = "{% static 'JS/upvote.js' %}"></script>
{% endblock %}